<!DOCTYPE html>
<html lang="en">
<head>    
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>íšŒì›ê°€ì…</title>    
    <style>
        @import url('https://webfontworld.github.io/cookierun/CookieRun.css');
        body {
            display: flex;
            align-items: center;
            justify-content: center;
            height: 100vh;
            margin: 0; 
        }
        
        fieldset {
            width: 500px;
            height: 700px;
            background-color: #ededed;
            padding-left: 30px;
            padding-right: 30px;
            padding-top: 70px;
        }

        /* ê°€ì…ë²„íŠ¼ */
        #submit_button {
            width: 450px;
            height: 50px;
            background-color: rgb(125, 160, 224);
            color: aliceblue;
            font-size: large;
            font-weight: bold;
        }

        /* inputë°•ìŠ¤ í´ë¦­ì‹œ í…Œë‘ë¦¬ ì—†ì• ê¸° */
        input:focus {outline:none;}

        /* ì´ë¦„ */
        .name {
            padding-bottom: 20px;
        }
        #name {
            width: 270px;
            border: none;
            border-bottom: dashed;
            background-color: #ededed;
        }

        /* ì•„ì´ë”” */
        .username {
            padding-bottom: 20px;
        }
        #username {
            width: 270px;
            border: none;
            border-bottom: dashed;
            background-color: #ededed;
        }
        
        /* íŒ¨ìŠ¤ì›Œë“œ */
        .password {
            padding-bottom: 20px;
        }
        #password {
            width: 270px;
            border: none;
            border-bottom: dashed;
            background-color: #ededed;
        }

        /* íŒ¨ìŠ¤ì›Œë“œ í™•ì¸ */
        .checkPassword {
            padding-bottom: 20px;
        }
        #checkPassword {
            width: 270px;
            border: none;
            border-bottom: dashed;
            background-color: #ededed;
        }

        /* ì „í™”ë²ˆí˜¸ */
        .checkPassword {
            padding-bottom: 20px;
        }
        #checkPassword {
            width: 270px;
            border: none;
            border-bottom: dashed;
            background-color: #ededed;
        }

        /* ì „í™”ë²ˆí˜¸ */
        .phone {
            padding-bottom: 20px;
        }
        #tel1 {
            width: 80px;
            border: none;
            border-bottom: dashed;
            background-color: #ededed;
        }
        #tel2 {
            width: 80px;
            border: none;
            border-bottom: dashed;
            background-color: #ededed;
        }
        #tel3 {
            width: 80px;
            border: none;
            border-bottom: dashed;
            background-color: #ededed;
        }

        /* ì´ë©”ì¼ */
        .email {
            padding-bottom: 30px;
            width: 500px;
        }
        #email1 {
            width: 123px;
            border: none;
            border-bottom: dashed;
            background-color: #ededed;
        }
        #email2 {
            width: 123px;
            border: none;
            border-bottom: dashed;
            background-color: #ededed;
        }
        /* ì£¼ì†Œ */
        .address {
            padding-bottom: 30px;
            width: 500px;
        }
        #address1 {
            width: 270px;
            border: none;
            border-bottom: dashed;
            background-color: #ededed;
        }
        #address2 {
            width: 270px;
            border: none;
            border-bottom: dashed;
            background-color: #ededed;
        }
    </style>
</head>
<body>
    <form name="signupFrm" action="javascript:requestSignup();">
        <fieldset style="border-radius: 10%;">
            <legend style="font-family: 'CookieRun'; font-size: larger;">í™ˆí˜ì´ì§€ íšŒì›ê°€ì… ì°½</legend>
            
            <div class="username" style="height: 52px;">
                <span style="padding-right: 92px; font-size: large; font-weight: 900;">ğŸ˜ì´ë¦„</span>
                <input type="text" name="username" id="username" required onblur="checkblur(this);" onfocus="checkfocus(this);">
                <span style="padding-left: 170px; font-weight: 100;">
                    <sup class="reqMsg" style="display:none; color: red;">í•„ìˆ˜ ì…ë ¥ì‚¬í•­ ì…ë‹ˆë‹¤.</sup>
                </span>
            </div>

            <div class="name" style="height: 52px;">
                <span style="padding-right: 76px; font-size: large; font-weight: 900;">ğŸ”‘ì•„ì´ë””</span>
                <input type="text" name="name" id="name" required onblur="checkblur(this);" onfocus="checkfocus(this);">
                <span style="padding-left: 170px; font-weight: 100;">
                    <sup class="reqMsg" style="display:none; color: red;">í•„ìˆ˜ ì…ë ¥ì‚¬í•­ ì…ë‹ˆë‹¤.</sup>
                </span>
            </div>

            <div class="password" style="height: 52px;">
                <span style="padding-right: 62px; font-size: large; font-weight: 900;">ğŸ”’íŒ¨ìŠ¤ì›Œë“œ</span> 
                <input type="password" name="password" id="password" required onblur="checkblur(this);" onfocus="checkfocus(this);"><br>
                <span style="padding-left: 170px; font-weight: 100;">
                    <sup id="pwdMsg" style="display:none">ì˜ë¬¸ì ëŒ€/ì†Œë¬¸ì, íŠ¹ìˆ˜ë¬¸ì, ìˆ«ì í¬í•¨ 8~32ì</sup>
                    <sup class="reqMsg" style="display:none; color: red;">í•„ìˆ˜ ì…ë ¥ì‚¬í•­ ì…ë‹ˆë‹¤.</sup>
                </span>
            </div>

            <div class="checkPassword" style="height: 52px;">
                <span style="padding-right: 15px; font-size: large; font-weight: 900;">ğŸ”íŒ¨ìŠ¤ì›Œë“œ í™•ì¸</span>
                <input type="password" name="checkPassword" id="checkPassword" required onblur="checkblur(this);" onfocus="checkfocus(this);">
                <span style="padding-left: 170px; font-weight: 100;">
                    <sup class="reqMsg" style="display:none; color: red;">í•„ìˆ˜ ì…ë ¥ì‚¬í•­ ì…ë‹ˆë‹¤.</sup>
                </span>
            </div>

            <div class="phone" style="height: 52px;">
                <span style="padding-right: 64px; font-size: large; font-weight: 900;">ğŸ“’ì „í™”ë²ˆí˜¸</span>
                <input type="phone" name="tel1" id="tel1" required onblur="checkblur(this);" onfocus="checkfocus(this);">-
                <input type="phone" name="tel2" id="tel2" required onblur="checkblur(this);" onfocus="checkfocus(this);">-
                <input type="phone" name="tel3" id="tel3" required onblur="checkblur(this);" onfocus="checkfocus(this);">
                <span style="padding-left: 170px; font-weight: 100;">
                    <sup class="reqMsg" style="display:none; color: red;">í•„ìˆ˜ ì…ë ¥ì‚¬í•­ ì…ë‹ˆë‹¤.</sup>
                </span>
            </div>

            <div class="email" style="height: 52px;">
                <span style="padding-right: 79px; font-size: large; font-weight: 900;">ğŸ“§ì´ë©”ì¼</span>
                <input type="text" name="email1" id="email1" style="width: 125px;">@<input type="text" name="email2" id="email2" style="width: 125px">
            </div>

            <div class="address">
                <span style="padding-right: 96px; font-size: large; font-weight: 900;">ğŸ“«ì£¼ì†Œ</span>
                <input type="text" name="address1" id="address1"><br><br>
                <span style="padding-left: 161px;"><input type="text" name="address2" id="address2" style="padding-top: 20px;" ></span>
            </div>

            <div style="padding-top: 30px; padding-left: 30px;">
                <input type="submit" id="submit_button" value="íšŒì›ê°€ì…"></input>
            </div>
            
        </fieldset>
    </form>
    <script>
        const frm = document.signupFrm;
        const name = frm.name;
        const username = frm.username;
        const password = frm.password;
        const checkPassword = frm['checkPassword'];
        const phone = frm.tel1 + '-' + frm.tel2 + '-' + frm.tel3;
        const email = frm.email1 +'@'+ frm.email2; 
        const address = frm.address1 + frm.address2; 

        document.signupFrm.onsubmit = (e) => {
            
            // ìœ íš¨ì„±ê²€ì‚¬

            // 1. ì´ë¦„ ìœ íš¨ì„±ê²€ì‚¬
            // í•œê¸€2ê¸€ì ì´ìƒë§Œ í—ˆìš©.
            const regExp0 = /^[ê°€-í£]{2,}$/;
            if (!regExpTest(regExp0, username, "í•œê¸€2ê¸€ìì´ìƒ ì…ë ¥í•˜ì„¸ìš”."))
                return false;

            // 2. ì•„ì´ë”” ìœ íš¨ì„±ê²€ì‚¬
            //ì²«ê¸€ìëŠ” ì˜ì†Œë¬¸ìë¡œ ì´ë£¨ì–´ì§€ê³ , ê¸¸ì´ëŠ” 4~12ê¸€ì, ìˆ«ì í•˜ë‚˜ì´ìƒ í¬í•¨
            const regExp1 = /^[a-z][a-z\d]{3,11}$/;
            const regExp2 = /[0-9]/;
            if(!regExpTest(regExp1
                        ,name
                        ,"ì•„ì´ë””ëŠ” ì˜ì†Œë¬¸ìë¡œ ì‹œì‘í•˜ëŠ” 4~12ê¸€ìì— ìˆ«ìí•˜ë‚˜ì´ìƒ í¬í•¨ì…ë‹ˆë‹¤."))
                return false; // submití•¸ë“¤ëŸ¬ ê¸°ë³¸ ì‘ë™(submit)ì„ ë°©ì§€
            if(!regExpTest(regExp2
                        ,name
                        ,"ì•„ì´ë””ëŠ” ìˆ«ìë¥¼ í•˜ë‚˜ì´ìƒ í¬í•¨í•˜ì„¸ìš”."))
                return false;

            //3. ë¹„ë°€ë²ˆí˜¸ ìœ íš¨ì„±ê²€ì‚¬
            const regExpArr = [/^.{8,15}$/, /\d/, /[a-zA-Z]/, /[\\*!&]/];

            for (let i = 0; i < regExpArr.length; i++) {
            if (
                !regExpTest(
                    regExpArr[i],
                    password,
                    "ë¹„ë°€ë²ˆí˜¸ëŠ” 8~15ìë¦¬ ìˆ«ì/ë¬¸ì/íŠ¹ìˆ˜ë¬¸ìë¥¼ í¬í•¨í•´ì•¼í•©ë‹ˆë‹¤."
                    )
                ) {
                    return false;
                }
            }

            //4. ë¹„ë°€ë²ˆí˜¸ì¼ì¹˜ì—¬ë¶€
            if (!isEqualPwd()) {
                return false;
            }

            //5. íœ´ëŒ€í°ë²ˆí˜¸ ê²€ì‚¬
            // 010-xxxx-xxxxí˜•ì‹ìœ¼ë¡œ ì…ë ¥
            if (!regExpTest(/^(010)$/, tel1, "010ì…ë ¥")) 
                return false;
            if (!regExpTest(/^[0-9]{4}$/, tel2, "4ìë¦¬ ë²ˆí˜¸ ì…ë ¥"))
                return false;
            if (!regExpTest(/^[0-9]{4}$/, tel3, "4ìë¦¬ ë²ˆí˜¸ ì…ë ¥"))
                return false;

        return true;

        };

        // í´ë¦­ì‹œ

        let pwdMsg = document.getElementById("pwdMsg");

        // íŒ¨ìŠ¤ì›Œë“œ í´ë¦­ì‹œ "ì˜ë¬¸ì ëŒ€/ì†Œë¬¸ì, íŠ¹ìˆ˜ë¬¸ì, ìˆ«ì í¬í•¨ 8~32ì"ë¬¸ì ì¶œë ¥
        password.addEventListener('click', () => {
            console.log(pwdMsg);
            pwdMsg.style.display="";
        });

        // focusì—ì„œ ë‚˜ê°ˆ ì‹œ "ì˜ë¬¸ì ëŒ€/ì†Œë¬¸ì, íŠ¹ìˆ˜ë¬¸ì, ìˆ«ì í¬í•¨ 8~32ì" ë¬¸êµ¬ ì‚¬ë¼ì§
        password.addEventListener('blur', () => {
            pwdMsg.style.display="none";
        });

        // inputì— ê´€í•œ ë¶„ê¸°ì²˜ë¦¬
        let reqMsgs = document.querySelectorAll('input');
        reqMsgs.forEach((input, index) => {
            input.addEventListener('click', () => {
                for(let i = 0; i < index; i++){
                    console.log(index)
                    if(i < 5){
                        checkblur(reqMsgs[i])
                    }
                }

            });
        });
        
        
        function checkblur(e){
            if(e.value == ""){
                e.parentElement.querySelector('.reqMsg').style.display="";
            }

        };

        function checkfocus(e){
            e.parentElement.querySelector('.reqMsg').style.display="none";
        };

         // í¼ ì œì¶œ ì—¬ë¶€
        const requestSignup = () => {
            const nameValue = name.value;  // ìˆ˜ì •
            const usernameValue = username.value;  // ìˆ˜ì •
            const passwordValue = password.value;  // ìˆ˜ì •
            const checkPasswordValue = checkPassword.value;  // ìˆ˜ì •
            const phoneValue = tel1.value + '-' + tel2.value + '-' + tel3.value;  // ìˆ˜ì •
            const emailValue = email1.value + '@' + email2.value;  // ìˆ˜ì •
            const addressValue = address1.value + ' ' + address2.value;  // ìˆ˜ì •

            console.log('íšŒì›ê°€ì… ì„±ê³µ~ ğŸ˜');
            alert(`${usernameValue} íšŒì›ê°€ì…ì„ í™˜ì˜í•©ë‹ˆë‹¤.`);
            saveUserInformation(nameValue, usernameValue, passwordValue, checkPasswordValue, phoneValue, emailValue, addressValue);  // ìˆ˜ì •
            frm.reset();  
        };

        // ë¹„ë°€ë²ˆí˜¸ ì¼ì¹˜ ì—¬ë¶€ í•¨ìˆ˜
        function isEqualPwd() {
            if (password.value === checkPassword.value) {
                return true;
            } 
            else {
                alert("ë¹„ë°€ë²ˆí˜¸ê°€ ì¼ì¹˜í•˜ì§€ ì•ŠìŠµë‹ˆë‹¤.");
                password.select();
                return false;
            }
        };

        // ì •ê·œì‹ ê´€ë ¨ í•¨ìˆ˜
        function regExpTest(regExp, el, msg) {
            if (regExp.test(el.value)) return true;
            //ì í•©í•œ ë¬¸ìì—´ì´ ì•„ë‹Œ ê²½ìš°
            alert(msg);
            el.focus();
            return false;
        };

        const saveUserInformation = (name, username, checkPassword, phone, email, address) => {
            // localStorageì— ì €ì¥
            // userInformationì— ì €ì¥ëœ ë°°ì—´ì´ ìˆë‹¤ë©´ ê·¸ê±¸ ì‚¬ìš©. ì—†ìœ¼ë©´ ìƒˆ ë°°ì—´ ìƒì„±.
            const userInformation = JSON.parse(localStorage.getItem('userInformation')) || [];
            userInformation.push(new UserInformation(name, username, checkPassword, phone, email, address));
            console.log(userInformation);

            localStorage.setItem('userInformation', JSON.stringify(userInformation));
            frm.reset();
        };

        class UserInformation {
            constructor(name, username, password, checkPassword, phone, email, address, createdAt = Date.now()) {
                this.name = name;
                this.username = username;
                this.password = password;
                this.checkPassword = checkPassword;
                this.phone = phone;
                this.email = email;
                this.address = address;
                this.createdAt = createdAt;
            }
        }
    </script>
</body>
</html>